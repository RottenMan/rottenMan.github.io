---
categories:
    - HTTP网络协议
tags:
	 - 图解HTTP
data: 2020-8-17 21:00:00
---



## HTTP报文

1. 用于 HTTP 协议交互的信息被称为 HTTP 报文
2. 请求端（客户端） 的HTTP 报文叫做请求报文
3.  响应端（服务器端） 的叫做响应报文
4. HTTP 报文本身是由多行（用 CR+LF 作换行符） 数据构成的字符串文本
5. HTTP 报文分为报文首部和报文主体两块

![](https://s1.ax1x.com/2020/08/17/dn9I9f.png)

## 请求报文及响应报文的结构

**请求报文（ 上） 和响应报文（ 下） 的结构**

![](https://s1.ax1x.com/2020/08/17/dn9TgS.png)



**请求报文（ 上） 和响应报文（ 下） 的实例**

![](https://s1.ax1x.com/2020/08/17/dn9buQ.png)



* 请求行：包含用于请求的方法， 请求 URI 和 HTTP 版本
* 状态行：包含表明响应结果的状态码， 原因短语和 HTTP 版本
* 首部字段：包含表示请求和响应的各种条件和属性的各类首部
  * 通用首部
  * 请求首部
  * 响应首部
  * 实体首部
* 其他：可能包含 HTTP 的 RFC 里未定义的首部（Cookie 等）



## 编码提升传输速率

HTTP 在传输数据时可以按照数据原貌直接传输， 也可以在传输过程中通过编码提升传输速率

编码的操作需要计算机来完成， 因此会消耗更多的 CPU 等资源



### 报文主体和实体主体的差异

* 报文

  是 HTTP 通信中的基本单位， 由 8 位组字节流（octet sequence，其中 octet 为 8 个比特） 组成， 通过 HTTP 通信传输

* 实体

  作为请求或响应的有效载荷数据（补充项） 被传输， 其内容由实体首部和实体主体组成



### 压缩传输的内容编码

内容编码指明应用在实体内容上的编码格式， 并保持实体信息原样压缩。 内容编码后的实体由客户端接收并负责解码

![](https://s1.ax1x.com/2020/08/17/dn9o38.png)



### 分割发送的分块传输编码

把实体主体分块的功能称为分块传输编码

![](https://s1.ax1x.com/2020/08/17/dn97jg.png)



## 发送多种数据的多部分对象集合

1. 邮件使用了 MIME 机制 可以处理文本、 图片、 视频等多个不同类型的数据
2.  MIME 扩展中使用一种称为**多部分对象集合**（Multipart） 的方法， 来容纳多份不同类型的数据



**多部分对象集合包含的对象👇**

* multipart/form-data

  在 Web 表单文件上传时使用

* multipart/byteranges

  状态码 206 响应报文包含了多个范围的内容时使用



**在 HTTP 报文中使用多部分对象集合时， 需要在首部字段里加上Content-type**



##  获取部分内容的范围请求

指定范围发送的请求叫做范围请求

![](https://s1.ax1x.com/2020/08/17/dn9LHs.png)

执行范围请求时， 会用到首部字段 Range 来指定资源的 byte 范围



* 5001~10 000 字节

  ```
  Range: bytes=5001-10000
  ```

* 从 5001 字节之后全部的

  ```
  Range: bytes=5001-
  ```

* 从一开始到 3000 字节和 5000~7000 字节的多重范围

  ```
  Range: bytes=-3000, 5000-7000
  ```

  

针对范围请求， 响应会返回状态码为 206 Partial Content 的响应报文

对于多重范围的范围请求， 响应会在首部字段 ContentType 标明 multipart/byteranges 后返回响应报文



## 内容协商返回最合适的内容

内容协商机制是指客户端和服务器端就响应的资源内容进行交涉， 然后提供给客户端最为适合的资源。 内容协商会以响应资源的语言、 字符集、 编码方式等作为判断的基准

![](https://s1.ax1x.com/2020/08/17/dn9qBj.png)